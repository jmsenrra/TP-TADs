\documentclass[10pt, a4paper]{article}
\usepackage[paper=a4paper, left=1.5cm, right=1.5cm, bottom=1.5cm, top=3.5cm]{geometry}
\usepackage[latin1]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[spanish]{babel}
\usepackage{indentfirst}
\usepackage{fancyhdr}
\usepackage{latexsym}
\usepackage{lastpage}
\usepackage{aed2-symb,aed2-itef,aed2-tad}
\usepackage[colorlinks=true, linkcolor=blue]{hyperref}
\usepackage{calc}

\newcommand{\f}[1]{\text{#1}}
\renewcommand{\paratodo}[2]{$\forall~#2$: #1}

\sloppy

\hypersetup{%
 % Para que el PDF se abra a página completa.
 pdfstartview= {FitH \hypercalcbp{\paperheight-\topmargin-1in-\headheight}},
 pdfauthor={Grupo x},
 pdfkeywords={TAD Mapa y TAD Campus},
 pdfsubject={TP TADs}
}

\parskip=5pt % 10pt es el tamaño de fuente

% Pongo en 0 la distancia extra entre ítemes.
\let\olditemize\itemize
\def\itemize{\olditemize\itemsep=0pt}

% Acomodo fancyhdr.
\pagestyle{fancy}
\thispagestyle{fancy}
\addtolength{\headheight}{1pt}
\lhead{Algoritmos y Estructuras de Datos II}
\rhead{$2^{\mathrm{er}}$ cuatrimestre de 2015}
\cfoot{\thepage /\pageref{LastPage}}
\renewcommand{\footrulewidth}{0.4pt}

\author{Grupo x}
\date{}
\title{TAD Mapa y TAD Campus}

\begin{document}

\section{TAD \tadNombre{Mapa}}

\begin{tad}{\tadNombre{Mapa}}
\tadGeneros{map}
\tadExporta{}
\tadUsa{\tadNombre{}}

\tadIgualdadObservacional{}{}{}{}
\tadAlinearFunciones{posicionesAMenorDistanciaAux\argumento = 0?}{asd123asd123asd123asd123aasdasdasdas/$n$,nat/$m$}
\tadObservadores

\tadOperacion{obstáculos}{map}{conj (posición)}{}
\tadOperacion{ancho}{map}{nat}{}
\tadOperacion{alto}{map}{nat}{}

\tadGeneradores

\tadOperacion{nuevoMapa}{nat /al, nat /an,conj(tupla(nat, nat)/obstaculos}{map}{$ (al \geq 1) \land(an \geq 1) \land ((\forall :o\hspace{0,1cm}tupla(nat\hspace{0,1cm} , \hspace{0,1cm}nat)) \hspace{0,1cm} o \in obstaculos \iff 1 \leq \Pi_1(o)\leq an \land 1 \leq \Pi_2(o)\leq al) $ }

\tadOtrasOperaciones

\tadOperacion{Distancia}{posición,posición}{nat (origen,destino)}{}
\tadOperacion{izquierda}{posición}{posición}{}
\tadOperacion{derecha}{posición}{posición}{}
\tadOperacion{arriba}{posición}{posición}{}
\tadOperacion{abajo}{map,posición}{bool}{}
\tadOperacion{fueraDelMapa}{posición}{posición}{}
\tadOperacion{posicionesAMenorDistancia}{posición,conj(posición)}{conj(posición)}{}
\tadOperacion{posicionesAMenorDistanciaAux}{posición,conj(posición)}{conj(posición)}{}
\tadOperacion{todosALaMismaDistancia}{posición /p,conj(posición) /ps}{bool}{$\neg \emptyset$?($ps$)}
\tadOperacion{todosALaMismaDistanciaAux}{posición /p,conj(posición) /ps}{bool}{$\neg \emptyset$?($ps$)}
\tadOperacion{hayUnoAMenorDistancia}{posición /p1,posición /p2,conj(posición) /ps}{bool}{$\neg \emptyset$?($ps$)}
\tadOperacion{estáArriba?}{posición,posición}{bool}{}
\tadOperacion{estáAbajo?}{posicion,posición}{bool}{}
\tadOperacion{estáDerecha?}{posición,posición}{bool}{}
\tadOperacion{estáIzquierda?}{posición,posición}{bool}{}
\tadOperacion{estáEnLaPrimeraDiagonal?}{posición,posición}{bool}{}
\tadOperacion{estáEnLaSegundaDiagonal?}{posición,posición}{bool}{}
\tadOperacion{estáEnLaTerceraDiagonal?}{posición,posición}{bool}{}
\tadOperacion{estáEnLaCuartaDiagonal?}{posición,posición}{bool}{}





\tadAxiomas[\paratodo{nat}{n, m}]
\tadAlinearAxiomas{PosicionesAMenorDistanciaAux(p,ps)}

\tadAxioma{obstaculos(nuevoMapa(al,an,obstaculos))}{obstaculos}
\tadAxioma{ancho(nuevoMapa(al,an))}{an}
\tadAxioma{alto(nuevoMapa(al,an))}{an}
\tadAxioma{$n+m$}{\IF\ $m=0?$ THEN $n$ ELSE suc($n$ $+$ pred($m$)) FI}
\tadAxioma{$n-m$}{\IF\ $m=0?$ THEN $n$ ELSE pred($n$) $-$ pred($m$) FI}
\tadAxioma{$n \times m$}{\IF\ $m=0?$ THEN $0$ ELSE $n$ $\times$ pred($m$) $+$ $n$ FI}
\tadAxioma{$n < m$}{$\lnot(m=0?)$ $\yluego$ $(n=0? \oluego\ \text{pred}(n)<\text{pred}(m))$}
\tadAxioma{$n \leq m$}{$n < m \lor n = m$}
\tadAxioma{$\min(n, m)$}{\IF\ $m < n$ THEN $m$ ELSE $n$ FI}
\tadAxioma{$\max(n, m)$}{\IF\ $m < n$ THEN $n$ ELSE $m$ FI}

\end{tad}

\section{TAD \tadNombre{Campus}}

\begin{tad}{\tadNombre{Campus}}
\tadIgualdadObservacional{}{}{}{}

\tadParametrosFormales{
    \tadEncabezadoInline{}{}
}

\tadGeneros{camp}
\tadExporta{}
\tadUsa{\tadNombre{}}

%notar la importancia de agrupar el ultimo parametro, para la coma
\tadAlinearFunciones{AgentesMasVigilantesAux}{clave,significado,{dicc(clave, significado)}}

\tadObservadores 
\tadOperacion{mapa}{camp}{map}{} 
\tadOperacion{estudiantes}{camp}{conj(posición)}{}
\tadOperacion{hippies}{camp}{conj(posición)}{}
\tadOperacion{agentes}{camp}{dicc(posición, agentes) }{}

\tadGeneradores
\tadOperacion{rastrillaje}{map /m, dicc(posición,agente)/a}{camp}{$((p \in claves(a)) \implies 
(\neg(fueraDelMapa(mapa(c), p))) \land \neg(p \in obstaculos(m)))) \land (\forall p1,p2: posicion) ((p1 \neq p2 \land def?(p1, a) \land def? (p2, a)) \implies (\Pi_1(obtener(p1,a)) \neq \Pi_1(obtener(p2, a)) \land \Pi_2(obtener(p1, a)) = 0 \land \Pi_2(obtener(p2, a)) = 0 \land (\Pi_3(obtener(p1, a)) = 0 \land \Pi_3(obtener(p2, a)) = 0)) $}
\tadOperacion{entraH}{camp /c, posición /p}{camp}{R1}
\tadOperacion{entraE}{camp /c, posición /p}{camp}{R1}
\tadOperacion{mueveH}{camp /c ,posición /p}{camp}{$(p \in hippies(c) $}
\tadOperacion{mueveE}{camp /c,posición /origen, posición /destino}{camp}{$ (origen \in estudiantes(c) ) \land (\neg (fueraDelMapa(map(c) \times destino))) $}
\tadOperacion{mueveA}{camp /c, posición /p}{camp}{$ (p \in claves(agentes(c))) \land (\Pi_3 (obtener(p \times agente(c))) < 3)  $}

{$R1:= (1 \leq \Pi_1(p)\leq ancho(m)) \land (\Pi_2(p) = 0 \lor \Pi_2(p) = alto(mapa(c))) \land (\neg(p \in obstaculos(mapa(c)))) \land (\neg(p \in estudiantes(c))) \land (\neg(p \in claves(agentes(c)))) \land (\neg(p \in hippies(c))$}

\tadOtrasOperaciones
\tadOperacion{cuántosHippies?}{camp}{nat}{}
\tadOperacion{cuántosEstudiantes?}{camp}{nat}{}
\tadOperacion{agenteMásVigilante}{camp}{nat}{}
\tadOperacion{agentesMásVigilantes}{camp,conj(posición)}{conj(posición)}{}
\tadOperacion{agentesMásVigilantesAux}{camp,conj(posición)}{conj(posición)}{}
\tadOperacion{todosIgualDeVigilantes}{camp,nat, conj(posición)}{bool}{}
\tadOperacion{hayUnoMásVigilante}{camp,posición, conj(posición)}{bool}{}
\tadOperacion{cuántosHippiesCerca?}{camp,posición}{nat}{}
\tadOperacion{lugarVacío?}{camp,posición}{bool}{}
\tadOperacion{opcionesDeMovimiento}{camp,posición}{conj(posición)}{}
\tadOperacion{hayUnoAlLado}{camp /c,posición /p, conj(posición) /ps}{bool}{$\neg \emptyset$?($ps$)}
\tadOperacion{nuevaPosición}{camp /c,posición /p, conj(posición) /ps}{posición}{$(p \in hippies(c)) \lor (p \in claves(agentes(c)))) \land \neg (\emptyset?(ps))$}


\tadAxiomas[\paratodo{dicc(clave, significado)}{d}, \paratodo{clave}{c, k}, \paratodo{significado}{s}]
\tadAlinearAxiomas{obtener($c$, definir($k$, $s$, $d$))}

\tadAxioma{def?($c$,vacío)}{false}
\tadAxioma{def?($c$, definir($k$, $s$, $d$)}{$c = k$ $\lor$ def?($c$, $d$)}

\tadAxioma{obtener($c$, definir($k$, $s$, $d$))}{\IF $c = k$ THEN $s$ ELSE obtener($c$, $d$) FI}

\tadAxioma{borrar($c$, definir($k$, $s$, $d$))}{\IF $c = k$ THEN {\IF def?($c$,$d$) THEN borrar($c$,$d$) ELSE $d$ FI} ELSE
definir($k$, $s$, borrar($c$, $d$)) FI}

\tadAxioma{claves(vacío)}{$\emptyset$}
\tadAxioma{claves(definir($c$,$s$,$d$))}{Ag($c$, claves($d$))}

\end{tad}

\end{document}
