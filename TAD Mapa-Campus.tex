\documentclass[10pt, a4paper]{article}
\usepackage[paper=a4paper, left=1.5cm, right=1.5cm, bottom=1.5cm, top=3.5cm]{geometry}
\usepackage[latin1]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[spanish]{babel}
\usepackage{indentfirst}
\usepackage{fancyhdr}
\usepackage{latexsym}
\usepackage{lastpage}
\usepackage{aed2-symb,aed2-itef,aed2-tad}
\usepackage[colorlinks=true, linkcolor=blue]{hyperref}
\usepackage{calc}
\deactivatequoting
\newcommand{\f}[1]{\text{#1}}
\renewcommand{\paratodo}[2]{$\forall~#2$: #1}
\sloppy
\hypersetup{%
 % Para que el PDF se abra a página completa.
 pdfstartview= {FitH \hypercalcbp{\paperheight-\topmargin-1in-\headheight}},
 pdfauthor={Grupo x},
 pdfkeywords={TAD Mapa y TAD Campus},
 pdfsubject={TP TADs}
}
\parskip=5pt % 10pt es el tamaño de fuente
% Pongo en 0 la distancia extra entre ítemes.
\let\olditemize\itemize
\def\itemize{\olditemize\itemsep=0pt}
% Acomodo fancyhdr.
\pagestyle{fancy}
\thispagestyle{fancy}
\addtolength{\headheight}{1pt}
\lhead{Trabajo Práctico de TADs}
\rhead{Grupo 7}
\cfoot{\thepage /\pageref{LastPage}}
\renewcommand{\footrulewidth}{0.4pt}
\author{Grupo 7}
\date{}
\title{TAD Mapa y TAD Campus}

\begin{document}

\noindent \textbf{TAD} \textsc {Posición} es \textsc {Tupla(nat $\times$ nat)}


\noindent \textbf{TAD}  {\tadNombre{Agente} es \tadNombre{Tupla(nat $\times$ nat $\times$ nat)\footnote{Placa x Capturas x Sanciones}}}



\begin{tad}{\tadNombre{Mapa}}
\tadGeneros{map}
\tadExporta{map,observadores, generadores, Distancia, Izquierda, Derecha, Arriba, Abajo, FueraDelMapa, PosicionesAMenorDistancia, EstáArriba?, EstáAbajo? EstáALaDerecha?, EstáALaIzquierda?, EstáEnLaPrimerDiagonal?, EstáEnLaSegundaDiagonal?, EstáEnLaTercerDiagonal?}
\tadUsa{\tadNombre{Bool}, \tadNombre{Nat}, \tadNombre{Posicion}}
\tadIgualdadObservacional{m_1}{m_2}{map}{obstáculos($m_1$) \igobs obstáculos($m_2$) $\wedge$ ancho($m_1$) \igobs ancho($m_2$) $\wedge$ alto($m_1$) \igobs ancho($m_2$)}

\tadAlinearFunciones{posicionesAMenorDistanciaAux}{nat /al, nat /an,conj(tupla(nat, nat)/obstaculos}

\tadObservadores
\tadOperacion{obstáculos}{map}{conj(posición)}{}
\tadOperacion{ancho}{map}{nat}{}
\tadOperacion{alto}{map}{nat}{}

\tadGeneradores
\tadOperacion{nuevoMapa}{nat /al, nat /an,conj(tupla(nat, nat)/obstaculos}{map}{(al $\geq$ 1) $\land$ (an $\geq$ 1) $\land$ (\paratodo{tupla(nat,nat)}{o}) (o $\in$ obstaculos $\iff$ (1 $\leq$ $\pi_1$(o) $\leq$ an $\land$ \newline 1 $\leq$ $\pi_2$(o) $\leq$ al))}

\tadOtrasOperaciones
\tadOperacion{Distancia}{posición,posición}{nat (origen,destino)}{}
\tadOperacion{Izquierda}{posición}{posición}{}
\tadOperacion{Derecha}{posición}{posición}{}
\tadOperacion{Arriba}{posición}{posición}{}
\tadOperacion{Abajo}{map,posición}{bool}{}
\tadOperacion{FueraDelMapa}{posición}{posición}{}
\tadOperacion{PosicionesAMenorDistancia}{posición,conj(posición)}{conj(posición)}{}
\tadOperacion{PosicionesAMenorDistanciaAux}{posición,conj(posición)}{conj(posición)}{}
\tadOperacion{TodosALaMismaDistancia}{posición /p,conj(posición) /ps}{bool}{$\neg\emptyset$?(ps)}
\tadOperacion{TodosALaMismaDistanciaAux}{posición /p,conj(posición) /ps}{bool}{$\neg \emptyset$?($ps$)}
\tadOperacion{HayUnoAMenorDistancia}{posición /p1,posición /p2,conj(posición) /ps}{bool}{$\neg\emptyset$?($ps$)}
\tadOperacion{EstáArriba?\footnotemark}{posición,posición}{bool}{}
\tadOperacion{EstáAbajo?}{posicion,posición}{bool}{}
\tadOperacion{EstáALaDerecha?}{posición,posición}{bool}{}
\tadOperacion{EstáALaIzquierda?}{posición,posición}{bool}{}
\tadOperacion{EstáEnLaPrimerDiagonal?}{posición,posición}{bool}{}
\tadOperacion{EstáEnLaSegundaDiagonal?}{posición,posición}{bool}{}
\tadOperacion{EstáEnLaTercerDiagonal?}{posición,posición}{bool}{}

\footnotetext{La primer posición con respecto a la segunda. Arriba es en su misma columna y por encima, abajo en la misma columna pero por debajo. Lo mismo con derecha e izquierda pero con respecto a la fila. La primer diagonal sería el primer cuadrante del mapa, pero tomando como centro la primer posición, y de la misma forma las otras diagonales.}

\tadAxiomas[\paratodo{map}{m}, \paratodo{nat}{an, al, d}, \paratodo{posición}{p, p1, p2}, \paratodo{conj(posición)}{obstáculos, ps}]

\tadAlinearAxiomas{obstaculos(nuevoMapa(al,an,obstaculos))}

\tadAxioma{obstaculos(nuevoMapa(al,an,obstaculos))}{obstaculos}
\tadAxioma{ancho(nuevoMapa(al,an))}{an}
\tadAxioma{alto(nuevoMapa(al,an))}{an}
\tadAxioma{Distancia (p1,p2)}{max($\pi_1$(p1), $\pi_1$(p2)) - min($\pi_1$(p1), $\pi_1$(p2))}
\tadAxioma {Izquierda(p)} {$\langle$ pred($\pi_1$(p)), $\pi_2$(p) $\rangle$}
\tadAxioma {Derecha(p)} {$\langle$ suc($\pi_1$(p)), $\pi_2$(p) $\rangle$}
\tadAxioma {Arriba(p)} {$\langle$ $\pi_1$(p), pred ($\pi_2$(p)) $\rangle$}
\tadAxioma {Abajo(p)} {$\langle$ $\pi_1$(p), suc($\pi_2$(p)) $\rangle$}
\tadAxioma {FueraDelMapa(m,p)} {$\pi_1$(p) < 1 $\lor$ $\pi_2$(p) < 1 $\lor$ ancho(m) < $\pi_1$(p) $\lor$ alto(m) < $\pi_2$(p)}
\tadAxioma{PosicionesAMenorDistancia(p,ps)}{\IF\ \#ps > 2 $\yluego$ TodosALaMismaDistancia(p,ps) THEN ps ELSE {\IF \#ps $\leq$ 2 THEN PosicionesAMenorDistanciaAux(p,ps) ELSE {\IF\ Distancia(dameUno(ps),p) < Distancia(dameUno(sinUno(ps)),p) THEN PosicionesAMenorDistancia(p,ps - {dameUno(sinUno(ps))}) ELSE {\IF\ Distancia(dameUno(ps), p) > Distancia(dameUno(sinUno(ps)),p) THEN PosicionesAMenorDistancia(p,sinUno(ps)) ELSE {\IF\ HayUnoAMenorDistancia(p, dameUno(ps),ps) THEN PosicionesAMenorDistancia(p,sinUno(sinUno(ps))) ELSE {dameUno(sinUno(ps))} $\cup$ {dameUno(ps)} $\cup$ PosicionesAMenorDistancia(p,sinUno(sinUno(ps))) FI} FI} FI} FI} FI}
\tadAxioma {PosicionesAMenorDistanciaAux(p,ps)} {{\IF\ \#ps > 2 THEN {\IF\ TodosALaMismaDistancia(p,ps) THEN ps ELSE {\IF\ Distancia(dameUno(ps), p) < Distancia(dameUno(sinUno(ps)),p) THEN PosicionesAMenorDistancia(p,ps - {dameUno(sinUno(ps))}) ELSE {\IF\ Distancia(dameUno(ps), p) > Distancia(dameUno(sinUno(ps)),p) THEN PosicionesAMenorDistancia(p,sinUno(ps)) ELSE {\IF\ HayUnoAMenorDistancia(p, dameUno(ps),ps) THEN PosicionesAMenorDistancia(p,sinUno(sinUno(ps))) ELSE {dameUno(sinUno(ps))} $\cup$ {dameUno(ps)} $\cup$ PosicionesAMenorDistancia(p,sinUno(sinUno(ps)))FI} FI} FI} FI} ELSE PosicionesAMenorDistanciaAux(p,ps) FI}}
\tadAxioma{TodosALaMismaDistancia(p,ps)}{TodosALaMismaDistanciaAux(p,Distancia(p,dameUno(ps)),ps)}
\tadAxioma{TodosALaMismaDistanciaAux(p,d,ps)}{{\IF\ (Distancia(p, dameUno(ps)) = d) y $\neg (\emptyset$?(sinUno(ps))) THEN TodosALaMismaDistanciaAux(p,d,sinUno(ps)) ELSE Distancia(p,dameUno(ps)) = d FI}}
\tadAxioma{HayUnoAMenorDistancia(p1,p2,ps)}{{\IF\ Distancia(p1,dameUno(ps)) < Distancia(p1,p2) THEN true ELSE {\IF\ $\emptyset$?(sinUno(ps)) THEN false ELSE HayUnoAMenorDistancia(p1,p2,sinUno(ps)) FI} FI}}
\tadAxioma{EstáArriba?(p1,p2)}{$\pi_1$(p1) = $\pi_1$(p2) $\land$ $\pi_2$(p1) > $\pi_2$(p2)}
\tadAxioma{EstáAbajo?(p1,p2)}{$\pi_1$(p1) = $\pi_1$(p2) $\land$ $\pi_2$(p1) < $\pi_2$(p2)}
\tadAxioma{EstáALaDerecha?(p1,p2)}{$\pi_1$(p1) > $\pi_1$(p2) $\land$ $\pi_2$(p1) = $\pi_2$(p2)}
\tadAxioma{EstáALaIzquierda?(p1,p2)}{$\pi_1$(p1) < $\pi_1$(p2) $\land$ $\pi_2$(p1) = $\pi_2$(p2)}
\tadAxioma{EstáEnLaPrimerDiagonal?(p1,p2)}{$\pi_1$(p1) > $\pi_1$(p2) $\land$ $\pi_2$(p1) > $\pi_2$(p2)}
\tadAxioma{EstáEnLaSegundaDiagonal?(p1,p2)}{$\pi_1$(p1) < $\pi_1$(p2) $\land$ $\pi_2$(p1) > $\pi_2$(p2)}
\tadAxioma{EstáEnLaTerceraDiagonal?(p1,p2)}{$\pi_1$(p1) < $\pi_1$(p2) $\land$ $\pi_2$(p1) < $\pi_2$(p2)}

\end{tad}

\begin{tad}{\tadNombre{Campus}}
\tadIgualdadObservacional{c1}{c2}{campus}{mapa(c1) \igobs mapa(c2) $\wedge$ estudiantes(c1) \igobs estudiantes(c2) $\wedge$ hippies(c1) \igobs hippies(c2) $\wedge$ agentes(c1) \igobs agentes(c2)}

\tadGeneros{camp}
\tadExporta{camp, observadores, generadores, \#hippies,  \#estudiantes, AgenteMásVigilante}
\tadUsa{\tadNombre{Bool}, \tadNombre{Nat}, \tadNombre{Posición}, \tadNombre{Agente}, \tadNombre{Mapa}, \tadNombre{Conj(Posición)}, \tadNombre{Dicc(Posición,Agente)}}

\tadAlinearFunciones{NuevaPosicionEnLaSegundaDiagonal}{camp /c,posición /origen, posición /destino}

\tadObservadores 
\tadOperacion{mapa}{camp}{map}{} 
\tadOperacion{estudiantes}{camp}{conj(posición)}{}
\tadOperacion{hippies}{camp}{conj(posición)}{}
\tadOperacion{agentes}{camp}{dicc(posición, agente) }{}

\tadGeneradores
\tadOperacion{rastrillaje}{map /m, dicc(posición,agente)/a}{camp}{((p $\in$ claves(a)) $\implies$ 
($\neg$(fueraDelMapa(mapa(c), p))) $\land$ $\neg$(p $\in$ obstaculos(m)))) $\land$ ($\forall$ p1, p2: posicion) ((p1 $\neq$ p2 $\land$ def?(p1, a) $\land$ def?(p2, a)) $\implies$ ($\pi_1$(obtener(p1,a)) $\neq$ $\pi_1$(obtener(p2, a)) $\land$ $\pi_2$(obtener(p1, a)) = 0 $\land$ $\pi_2$(obtener(p2, a)) = 0 $\land$ ($\pi_3$(obtener(p1, a)) = 0 $\land$ \newline $\pi_3$(obtener(p2, a)) = 0))}
\tadOperacion{entraH}{camp /c, posición /p}{camp}{R1}
\tadOperacion{entraE}{camp /c, posición /p}{camp}{R1}
\tadOperacion{mueveH}{camp /c ,posición /p}{camp}{p $\in$ hippies(c)}
\tadOperacion{mueveE}{camp /c,posición /origen, posición /destino}{camp}{(origen $\in$ estudiantes(c)) $\land$ ($\neg$(fueraDelMapa(map(c) $\times$ destino)))}
\tadOperacion{mueveA}{camp /c, posición /p}{camp}{(p $\in$ claves(agentes(c))) $\land$ ($\pi_3$(obtener(p,agente(c))) < 3)}

R1 := 1 $\leq$ $\pi_1$(p) $\leq$ ancho(m) $\land$ ($\pi_2$(p) = 0 $\lor$ $\pi_2$(p) = alto(mapa(c))) $\land$ $\neg$(p $\in$ obstaculos(mapa(c))) $\land$ $\neg$(p $\in$ estudiantes(c)) $\land$ $\neg$(p $\in$ claves(agentes(c))) $\land$ $\neg$(p $\in$ hippies(c))

\tadOtrasOperaciones
\tadOperacion{\#hippies}{camp}{nat}{}
\tadOperacion{\#estudiantes}{camp}{nat}{}
\tadOperacion{AgenteMásVigilante}{camp}{nat}{}
\tadOperacion{AgentesMásVigilantes}{camp,conj(posición)}{conj(posición)}{}
\tadOperacion{AgentesMásVigilantesAux}{camp,conj(posición)}{conj(posición)}{}
\tadOperacion{TodosIgualDeVigilantes}{camp,nat, conj(posición)}{bool}{}
\tadOperacion{HayUnoMásVigilante}{camp,posición, conj(posición)}{bool}{}
\tadOperacion{AgenteConPlacaMasChica}{camp, conj(posición)}{agente}{}
\tadOperacion{AgenteConPlacaMasChicaAux}{camp, posición, conj(posición)}{agente}{}
\tadOperacion{HayUnaPlacaMasChica}{camp, posición, conj(posición)}{bool}{}
\tadOperacion{\#hippiesCerca}{camp,posición}{nat}{}
\tadOperacion{LugarVacío?}{camp,posición}{bool}{}
\tadOperacion{OpcionesDeMovimiento}{camp,posición}{conj(posición)}{}
\tadOperacion{HayUnoAlLado}{camp /c,posición /p, conj(posición) /ps}{bool}{$\neg \emptyset$?(ps)}
\tadOperacion{NuevaPosición\footnotemark}{camp /c,posición /p, conj(posición) /ps}{posición}{R2}
\tadOperacion{NuevaPosicionArriba}{camp /c, posicion /p, conj(posicion) /ps}{posición}{R2}
\tadOperacion{NuevaPosicionAbajo}{camp /c, posicion /p, conj(posicion) /ps}{posición}{R2}
\tadOperacion{NuevaPosicionALaDerecha}{camp /c, posicion /p, conj(posicion) /ps}{posición}{R2}
\tadOperacion{NuevaPosicionALaIzquierda}{camp /c, posicion /p, conj(posicion) /ps}{posición}{R2}
\tadOperacion{NuevaPosicionEnLaPrimerDiagonal}{camp /c, posicion /p, conj(posicion) /ps}{posición}{R2}
\tadOperacion{NuevaPosicionEnLaSegundaDiagonal}{camp /c, posicion /p, conj(posicion) /ps}{posición}{R2}
\tadOperacion{NuevaPosicionEnLaTercerDiagonal}{camp /c, posicion /p, conj(posicion) /ps}{posición}{R2}


R2 := (p $\in$ hippies(c)) $\lor$ (p $\in$ claves(agentes(c)))) $\land$ $\neg(\emptyset$?(ps))

\footnotetext{Toma la posición del que se va a mover y el conjunto de posiciones de las personas a las que quiere llegar (hippies en el caso de los agentes, y estudiantes en el caso de los hippies).}

\tadAxiomas[\paratodo{camp}{c}, \paratodo{map}{m}, \paratodo{posición}{p, p1, p2}, \paratodo{conj(posición)}{ps}, \paratodo{dicc(posicion,agente)}{a},\newline \paratodo{nat}{capturas}]

\tadAlinearAxiomas{NuevaPosicionEnLaSegundaDiagonal(c,p,ps)}

\tadAxioma{mapa(rastrillaje(m,a))}{m}
\tadAxioma{mapa(entraH(c,p))}{mapa(c)}
\tadAxioma{mapa(entraE(c,p))}{mapa(c)}
\tadAxioma{mapa(mueveH(c,p))}{mapa(c)}
\tadAxioma{mapa(mueveE(c,p1,p2))}{mapa(c)}
\tadAxioma{mapa(mueveA(c,p))}{mapa(c)}
\tadAxioma{estudiantes(rastrillaje(m,a))}{$\emptyset$}
\tadAxioma{estudiantes(entraH(c,p))}{$\pi_1$(hNuevo(c,p))} 
\tadAxioma{estudiantes(entraE(c,p))}{$\pi_1$(eNuevo(c,p))}
\tadAxioma{estudiantes(mueveH(c,p))}{$\pi_1$(hMovido(c,p,NuevaPosicion(c,p,estudiantes(c))))}
\tadAxioma{estudiantes(mueveE(c,p1,p2))}{$\pi_1$(eMovido(c,p1,p2))}
\tadAxioma{estudiantes(mueveA(c,p))}{$\pi_1$(aMovido(c,p,NuevaPosicion(c,p,hippies(c))))}
\tadAxioma{hippies(rastrillaje(m,a))}{$\emptyset$}
\tadAxioma{hippies(entraH(c,p))}{$\pi_2$(hNuevo(c,p))}
\tadAxioma{hippies(entraE(c,p))}{$\pi_2$(eNuevo(c,p))}
\tadAxioma{hippies(mueveH(c,p))}{$\pi_2$(hMovido(c,p,NuevaPosicion(c,p,estudiantes(c))))}
\tadAxioma{hippies(mueveE(c,p1,p2))}{$\pi_2$(eMovido(c,p1,p2))}
\tadAxioma{hippies(mueveA(c,p))}{ $\pi_2$(aMovido(c,p,NuevaPosicion(c,p,hippies(c))))}
\tadAxioma{agentes(rastrillaje(m,a))}{a}
\tadAxioma{agentes(entraH(c,p))}{pi3(hNuevo(c,p))}
\tadAxioma{agentes(entraE(c,p))}{pi3(eNuevo(c,p))}
\tadAxioma{agentes(mueveH(c,p))}{ $\pi_3$(hMovido(c,p,NuevaPosicion(c,p,estudiantes(c))))}
\tadAxioma{agentes(mueveE(c,p1,p2))}{pi3(eMovido(c,p1,p2))}
\tadAxioma{agentes(mueveA(c,p))}{ $\pi_3$(aMovido(c,p,NuevaPosicion(c,p,hippies(c))))}
\tadAxioma{\#hippies(c)}{\#hippies(c)}
\tadAxioma{\#estudiantes(c)}{\#estudiantes(c)}
\tadAxioma{AgenteMasVigilante(c)}{ $\pi_1$(AgenteConPlacaMasChica(c, AgentesMasVigilantes(c, claves(agentes(c)))))}
\tadAxioma{AgentesMasVigilantes(c,ps)}{\IF \#ps > 2 THEN{\IF TodosIgualDeVigilantes(c,$\pi_2$(obtener(dameUno(ps)),agentes(c)) \newline ,ps) THEN ps ELSE {\IF $\pi_2$(obtener(dameUno(ps),agentes(c))) < $\pi_2$(obtener(dameUno(sinUno(ps)),agentes(c))) THEN AgentesMasVigilantes(c,ps - {dameUno(ps)}) ELSE {\IF $\pi_2$(obtener(dameUno(ps),agentes(c))) > $\pi_2$(obtener(dameUno(sinUno(ps)),agentes(c))) THEN AgentesMasVigilantes(c,ps - {dameUno(sinUno(ps))}) ELSE {\IF HayUnoMasVigilante(c,dameUno(ps),ps) THEN AgentesMasVigilantes(c,sinUno(sinUno(ps))) ELSE {dameUno(sinUno(ps))} $\cup$ {dameUno(ps)} $\cup$ AgentesMasVigilantes(c,sinUno(sinUno(ps))) FI} FI} FI} FI} ELSE AgentesMasVigilantesAux(c,ps)FI}
\tadAxioma{AgentesMasVigilantesAux(c,ps)}{\IF \#ps == 1 THEN ps ELSE {\IF $\pi_2$(obtener(dameUno(ps),agentes(c))) > $\pi_2$(obtener(dameUno(sinUno(ps)),agentes(c))) THEN {dameUno(ps)} ELSE {\IF $\pi_2$(obtener(dameUno(ps),agentes(c))) < $\pi_2$(obtener(dameUno(sinUno(ps)),agentes(c))) THEN {dameUno(sinUno(ps))} ELSE ps FI} FI} FI}
\tadAxioma{TodosIgualDeVigilantes(c,capturas,ps)}{\IF $\pi_2$(obtener(dameUno(ps),agentes(c))) == capturas $\wedge$ $\neg$($\emptyset$?(sinUno(ps))) THEN TodosIgualDeVigilantes(c,capturas,sinUno(ps)) ELSE $\pi_2$(obtener(dameUno(ps),agentes(c))) == capturas FI}
\tadAxioma{HayUnoMasVigilante(c,p,ps)}{\IF $\pi_2$(obtener(dameUno(ps),agentes(c))) > $\pi_2$(obtener(p,agentes(c))) THEN true ELSE {\IF $\neg$($\emptyset$?(sinUno(ps))) THEN HayUnoMasVigilante(c,p,sinUno(ps)) ELSE false FI} FI}
\tadAxioma{AgenteConPlacaMasChica(c,ps)}{AgenteConPlacaMasChicaAux(c, dameUno(ps), sinUno(ps))}
\tadAxioma{AgenteConPlacaMasChicaAux(c, p, ps)}{\IF HayUnaPlacaMasChica(c, p, ps) THEN AgenteConPlacaMasChicaAux(c, dameUno(ps), sinUno(ps)) ELSE obtener(p, agentes(c)) FI}
\tadAxioma{HayUnaPlacaMasChica(c, p, ps)}{\IF \#ps $\leq$ 2 THEN {\IF $\pi_1$(obtener(dameUno(ps), agentes(c))) < $\pi_1$(obtener(p, agentes(c))) THEN true ELSE {\IF $\not$vacio?(sinUno(ps)) THEN HayUnaPlacaMasChica(c, p, sinUno(ps)) ELSE false FI} FI} ELSE false FI}
\tadAxioma{\#hippiesCerca(c,p)}{$\beta$(Arriba(p) $\in$ hippies(c)) + $\beta$(Abajo(p) $\in$ hippies(c)) + $\beta$(Derecha(p) $\in$ hippies(c)) + $\beta$(Izquierda(p) $\in$ hippies(c))}
\tadAxioma{LugarVacío?(c,p)}{$\neg$(p $\in$ estudiantes(c)) $\wedge$ $\neg$(p $\in$ hippies(c)) $\wedge$ $\neg$(p $\in$ claves(agentes(c))) $\wedge$ $\neg$(p $\in$ obstáculos(mapa(c)))}
%estaría bueno poner los ifs en una linea, pero no ome d
\tadAxioma{OpcionesDeMovimiento(c,p)}{({\IF LugarVacío?(c,Arriba(p)) $\wedge$ $\neg$(FueraDelMapa(mapa(c),Arriba(p))) THEN {Arriba(p)} ELSE $\emptyset$? FI}) $\cup$ ({\IF LugarVacío?(c,Abajo(p)) $\wedge$ $\neg$(FueraDelMapa(mapa(c),Abajo(p))) THEN {Abajo(p)} ELSE $\emptyset$? FI}) $\cup$ ({\IF LugarVacío?(c,Derecha(p)) $\wedge$ $\neg$(FueraDelMapa(mapa(c),Derecha(p))) THEN {Derecha(p)} ELSE $\emptyset$? FI}) $\cup$ ({\IF LugarVacío?(c,Izquierda(p)) $\wedge$ $\neg$(FueraDelMapa(mapa(c),Izquierda(p))) THEN {Izquierda(p)} ELSE $\emptyset$? FI})}
\tadAxioma{HayUnoAlLado(c,p,ps)}{\IF \#ps = 1 THEN Distancia(p,dameUno(ps)) = 1 ELSE {\IF Distancia(p,dameUno(ps)) = 1 THEN true ELSE HayUnoAlLado(c,p,sinUno(ps)) FI} FI}
\tadAxioma{NuevaPosición\footnotemark(c,p,ps)}{{\IF HayUnoAlLado(c,p,ps) THEN p ELSE {\IF EstáArriba?(dameUno(PosicionesAMenorDistancia(p,ps)),p) THEN NuevaPosiciónArriba(c,p,ps) ELSE {\IF EstáAbajo?(dameUno(PosicionesAMenorDistancia(p,ps)),p) THEN NuevaPosiciónAbajo(c,p,ps) ELSE {\IF EstáALaDerecha?(dameUno(PosicionesA- \newline MenorDistancia(p,ps)),p) THEN NuevaPosiciónALaDerecha(c,p,ps) ELSE {\IF EstáALaIzquierda?(dameUno(PosicionesAMenorDistancia(p,ps)),p) THEN NuevaPosiciónALaIzquierda(c,p,ps) ELSE {\IF EstáEnLaPrimerDiagonal?(dameUno(PosicionesAMenorDistancia(p,ps)),p) THEN NuevaPosiciónEnLaPrimerDiagonal(c,p,ps) ELSE {\IF 
EstáEnLaSegundaDiagonal?(dameUno(PosicionesAMenorDistancia(p,ps)) \newline ,p) THEN NuevaPosiciónEnLaSegundaDiagonal(c,p,ps) ELSE {\IF 
EstáEnLaTercerDiagonal?(dameUno(PosicionesAMenorDistancia(p, \newline ps)),p) THEN NuevaPosiciónEnLaTercerDiagonal(c,p,ps)  ELSE {\IF dameUno({$\langle$ $\pi_1$(p) + 1,$\pi_2$(p)$\rangle$} $\cup$ {$\langle$ $\pi_1$(p),$\pi_2$(p) - 1$\rangle$}) $\in$ OpcionesDeMovimiento(c,p) THEN dameUno({$\langle$ $\pi_1$(p) + 1,$\pi_2$(p) $\rangle$} $\cup$ {$\langle$ $\pi_1$(p),$\pi_2$(p) - 1 $\rangle$}) ELSE {\IF dameUno(sinUno({$\langle$ $\pi_1$(p) + 1,$\pi_2$(p) $\rangle$} $\cup$ {$\langle$ $\pi_1$(p),$\pi_2$(p) - 1 $\rangle$})) $\in$ OpcionesDeMovimiento(c,p) THEN dameUno(sinUno({$\langle$ $\pi_1$(p) + 1,$\pi_2$(p)$\rangle$} $\cup$ {$\langle$ $\pi_1$(p),$\pi_2$(p) - 1$\rangle$})) ELSE dameUno(OpcionesDeMovimiento(c, \newline p)) FI} FI} FI} FI} FI} FI} FI} FI} FI} FI}}
\tadAxioma{NuevaPosiciónArriba(c,p,ps)}{\IF $\langle$ $\pi_1$(p),$\pi_2$(p) + 1$\rangle$ $\in$ OpcionesDeMovimiento(c,p) THEN $\langle$ $\pi_1$(p),$\pi_2$(p) + 1 $\rangle$ ELSE dameUno(PosicionesAMenorDistancia(dameUno(PosicionesA-\newline MenorDistancia(p,ps)),OpcionesDeMovimiento(c,p))) FI}
\tadAxioma{NuevaPosiciónAbajo(c,p,ps)}{\IF $\langle$ $\pi_1$(p),$\pi_2$(p) - 1 $\rangle$ $\in$ OpcionesDeMovimiento(c,p) THEN $\langle$ $\pi_1$(p),$\pi_2$(p) - 1 $\rangle$ ELSE dameUno(PosicionesAMenorDistancia(dameUno(PosicionesAMe- \newline norDistancia(p,ps)),OpcionesDeMovimiento(c,p))) FI}
\tadAxioma{NuevaPosiciónALaDerecha(c,p,ps)}{\IF $\langle$ $\pi_1$(p) + 1,$\pi_2$(p) $\rangle$ $\in$ OpcionesDeMovimiento(c,p) THEN $\langle$ $\pi_1$(p) + 1,$\pi_2$(p) $\rangle$ ELSE dameUno(PosicionesAMenorDistancia(dameUno(PosicionesAMe- \newline norDistancia(p,ps)),OpcionesDeMovimiento(c,p))) FI} 
\tadAxioma{NuevaPosiciónALaIzquierda(c,p,ps)}{\IF  $\langle$ $\pi_1$(p) - 1,$\pi_2$(p)$\rangle$ $\in$ OpcionesDeMovimiento(c,p) THEN $\langle$ $\pi_1$(p) - 1,$\pi_2$(p) $\rangle$ ELSE dameUno(PosicionesAMenorDistancia(dameUno(PosicionesAMe- \newline norDistancia(p,ps)),OpcionesDeMovimiento(c,p))) FI}
\tadAxioma{NuevaPosiciónEnLaPrimerDiagonal(c,p,ps)}{\IF dameUno({ $\langle$ $\pi_1$(p) + 1,$\pi_2$(p)$\rangle$} $\cup$ {$\langle$ $\pi_1$(p),$\pi_2$(p) + 1$\rangle$}) $\in$ OpcionesDeMovimiento(c,p) THEN dameUno({$\langle$ $\pi_1$(p) + 1,$\pi_2$(p) $\rangle$} $\cup$ {$\langle$ $\pi_1$(p),$\pi_2$(p) + 1 $\rangle$}) ELSE {\IF dameUno(sinUno({$\langle$ $\pi_1$(p) + 1,$\pi_2$(p) $\rangle$} $\cup$ {$\langle$ $\pi_1$(p),$\pi_2$(p) + 1 $\rangle$})) $\in$ OpcionesDeMovimiento(c,p) THEN dameUno(sinUno({$\langle$ $\pi_1$(p) + 1,$\pi_2$(p) $\rangle$} $\cup$ {$\langle$ $\pi_1$(p),$\pi_2$(p) + 1 $\rangle$})) ELSE dameUno(OpcionesDeMovimiento(c,p)) FI} FI}
\tadAxioma{NuevaPosicionEnLaSegundaDiagonal(c,p,ps)}{\IF dameUno({$\langle$ $\pi_1$(p) - 1,$\pi_2$(p) $\rangle$} $\cup$ {$\langle$ $\pi_1$(p),$\pi_2$(p) + 1 $\rangle$}) $\in$ OpcionesDeMovimiento(c,p) THEN dameUno({$\langle$ $\pi_1$(p) - 1,$\pi_2$(p) $\rangle$} $\cup$ {$\langle$ $\pi_1$(p),$\pi_2$(p) + 1 $\rangle$}) ELSE {\IF dameUno(sinUno({$\langle$ $\pi_1$(p) - 1,$\pi_2$(p) $\rangle$} $\cup$ {$\langle$ $\pi_1$(p),$\pi_2$(p) + 1 $\rangle$})) $\in$ OpcionesDeMovimiento(c,p) THEN dameUno(sinUno({$\langle$ $\pi_1$(p) - 1,$\pi_2$(p) $\rangle$} $\cup$ {$\langle$ $\pi_1$(p),$\pi_2$(p) + 1 $\rangle$})) ELSE dameUno(OpcionesDeMovimiento(c,p)) FI} FI}
\tadAxioma{NuevaPosicionEnLaTercerDiagonal(c,p,ps)}{\IF dameUno({$\langle$ $\pi_1$(p) - 1,$\pi_2$(p) $\rangle$} $\cup$ {$\langle$ $\pi_1$(p),$\pi_2$(p) - 1 $\rangle$}) $\in$ OpcionesDeMovimiento(c,p) THEN dameUno({$\langle$ $\pi_1$(p) - 1,$\pi_2$(p) $\rangle$} $\cup$ {$\langle$ $\pi_1$(p),$\pi_2$(p) - 1 $\rangle$}) ELSE {\IF dameUno(sinUno({$\langle$ $\pi_1$(p) - 1,$\pi_2$(p)$\rangle$} $\cup$ {$\langle$ $\pi_1$(p),$\pi_2$(p) - 1$\rangle$})) $\in$ OpcionesDeMovimiento(c,p) THEN dameUno(sinUno({$\langle$ $\pi_1$(p) - 1,$\pi_2$(p)$\rangle$} $\cup$ {$\langle$ $\pi_1$(p),$\pi_2$(p) - 1$\rangle$})) ELSE dameUno(OpcionesDeMovimiento(c,p)) FI} FI}

\footnotetext{La persona (hippie o estudiante) a alcanzar puede estar arriba, abajo, etc. (ver nota 2), por eso en el último else la persona está en el sector del mapa que queda: en la cuarta diagonal.}
\end{tad}

\end{document}
